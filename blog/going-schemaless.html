<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Tips for schemaless design</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Recommendations that can be taken into account before going schemaless">
    <meta name="keywords" content="schemaless, lessons learned">
    <meta name="author" content="Ahmad Samiei">
    <link rel="dns-prefetch" href="https://google-analytics.com">
    <link rel="alternate" href="/" hreflang="en-us" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" media="screen, tv, handheld" href="/assets/css/app.min.css?v=409e5807ac4432cf418cf3616dd8fe23">
    <link rel="shortcut icon" media="screen, tv, handheld" type="image/png" href="/favicon.ico"/>
    <link rel="icon" media="screen, tv, handheld" type="image/png" sizes="16x16" href="/assets/img/favicon-16x16.png">
    <link rel="icon" media="screen, tv, handheld" href="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" type="image/gif">
</head>
<body data-theme="light">
    <header class="blog-header py-3">
        <div class="container">
            <div class="row flex-nowrap justify-content-between align-items-center">
                <div class="col-4 pt-1">
                    <a class="text-muted" href="/">‚Üê Home</a>
                </div>
                <div class="col-8 d-flex justify-content-end align-items-center">
                    <nav class="my-2 my-md-0 mr-md-3">
                        <a class="p-2" href="/">Posts</a>
                        <a class="p-2" href="/my-reading-list.html">Reading list</a>
                        <a class="p-2" href="https://twitter.com/Ahmad_Samiei"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"></path></svg></a>
                        <a class="p-2" href="http://github.com/amad"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"></path></svg></a>
                        <a class="p-2" href="http://linkedin.com/in/ahmadsamiei/"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg></a>
                        <a class="p-2" href="/rss.xml"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
                        <a class="p-4 pl-4" id="toggler" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 100 110" fill="currentcolor" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22.67 50A27.33 27.33 0 1 0 50 22.67 27.34 27.34 0 0 0 22.67 50zm27.59-20.17a20.43 20.43 0 0 1 0 40.86zM52 17.06V4.8a2.3 2.3 0 1 0-4.59 0v12.26a2.3 2.3 0 0 0 4.59 0zm31.37 2.42a2.3 2.3 0 0 0-3.25-3.25l-8.63 8.67a2.3 2.3 0 0 0 3.25 3.25zM82.94 52H95.2a2.3 2.3 0 1 0 0-4.59H82.94a2.3 2.3 0 0 0 0 4.59zM71.85 71.49a2.29 2.29 0 0 0 0 3.25l8.67 8.67a2.31 2.31 0 0 0 3.25 0 2.29 2.29 0 0 0 0-3.25l-8.67-8.67a2.29 2.29 0 0 0-3.25 0zM48 82.94V95.2a2.3 2.3 0 1 0 4.59 0V82.94a2.3 2.3 0 0 0-4.59 0zm-31.41-2.42a2.3 2.3 0 0 0 1.63 3.92 2.27 2.27 0 0 0 1.62-.67l8.67-8.67a2.3 2.3 0 0 0-3.25-3.25zM2.5 50.26a2.3 2.3 0 0 0 2.3 2.29h12.26a2.3 2.3 0 0 0 0-4.59H4.8a2.3 2.3 0 0 0-2.3 2.3zm25.65-21.75a2.29 2.29 0 0 0 0-3.25l-8.67-8.67a2.3 2.3 0 0 0-3.25 3.25l8.67 8.67a2.31 2.31 0 0 0 3.25 0z"/></svg></a>
                    </nav>
                </div>
            </div>
        </div>
    </header>

<div class="container">
        <div class="row justify-content-center mt-4">
        <article class="post col-12 col-md-10 col-lg-8">
            <h1>Tips for schemaless design</h1>
            <span class="post-time text-muted font-weight-light text-monospace">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                <time datetime="2017-03-06">06 Mar 2017</time>
            </span>
            <p>With schemaless databases, you benefit from transparent database adjustments. They do not enforce any structure for your data, but in most cases, you will have a reasonably consistent model. The software industry is getting agiler also means that we are dealing with more ever-changing entities. And probably that is one of the reasons that schemaless databases are a good fit.</p>
<p>Schemaless databases have been around for a while, but comparing with the Relational model, they are still quite new, and a lot of development teams do not understand the tradeoffs.</p>
<p>I want to list a few things that I learned working on schemaless projects in the past few years.</p>
<p>In most cases, there is a consistent model (at least in your code!). If your project is not one of the exceptions, most of these recommendations are going to help you down the road. But some of them might differ in some cases.</p>
<h2>While starting:</h2>
<ul>
<li>Think about application requirements. You don't have to define your model, but you should have a rough idea of it.</li>
<li>Find a right performance balance. Do you want to have read optimized model or write optimized model?</li>
<li>Make sure your team understands shard keys, and you know how your database is going to handle sharding and partitioning. Databases are using similar patterns but implemented differently.</li>
<li>Investigate analytics and reporting expectations.</li>
<li>Make sure the ops team does support your database technology.</li>
<li>Be careful with your shard keys from the beginning. Understand performance impact of your model on distributed systems.</li>
</ul>
<h2>While building:</h2>
<ul>
<li>It is better if your code/API can enforce an explicit schema because your database is not going to give you an error when your data does not fit your implicit schema. This way your code is going to make less assumptions about the data structure.</li>
<li>If you have downstream dependencies, consider using triggers (event-streams in some databases). Schemaless can be a perfect source-of-truth data store when using triggers. But do not forget to document downstream dependencies, their requirements, integration method, and the way you are notifying them. It will help you in change management, especially with schema changes.</li>
<li>You can migrate data during reading or migrate all data in one go (Some databases have tools for that. However in some cases, you have to build an ETL process). Removing support for the old data structure from your code is essential after migration.</li>
<li>Wrap your schemaless data with determined methods wherever you want to use your data. You want to make sure fewer part of the software is dependent on the structure. Data access layer is the first place to start.</li>
<li>Do not mix custom fields or meta-information with your implicit schema (ex. fields that are only to display something in the UI, any information that base software is not using. dates for instance). An easy way is to put them under a meta information namespace in your JSON object.</li>
<li>If you have to deal with non-uniform data where fields differ between individual records, (events are a good example), try to add sub-types. Thus, it is easier to know what properties are expected depending on the sub-type. If you have many changes in your data structure and it is natural for your project, you can think about versioning, so your code can behave base on version instead of attributes.</li>
<li>Don't get paranoid about schema; it is going to be fine.</li>
</ul>
        </article>
    </div>
    <div class="row justify-content-center">
        <div class="col-12 col-md-10 col-lg-8">
            <hr />
            <a
                href="//twitter.com/share"
                class="twitter-share-button"
                data-url="https://amad.github.io/blog/going-schemaless.html"
                data-via="Ahmad_Samiei"
                data-hashtags="schemaless,lessonslearned"
                data-dnt="true"
                data-counturl="https://amad.github.io/blog/going-schemaless.html"
            >
                Tweet
            </a>
            <a
                class="twitter-follow-button"
                href="https://twitter.com/Ahmad_Samiei"
            >
                Follow @Ahmad_Samiei
            </a>
        </div>
    </div>
            <div class="row justify-content-center">
            <div class="col-12 col-md-10 col-lg-8 comments">
                <div id="disqus_thread"></div>
                <script defer>
                    var disqus_config = function () {
                        this.page.url = "https://amad.github.io/blog/going-schemaless.html";
                        this.page.identifier = "/blog/going-schemaless.html";
                    };
                    (function() { // DON'T EDIT BELOW THIS LINE
                    var d = document, s = d.createElement('script');
                    s.src = 'https://samiei-org.disqus.com/embed.js';
                    s.setAttribute('data-timestamp', +new Date());
                    (d.head || d.body).appendChild(s);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </div>
        </div>
    </div>

    <footer>
    <div class="container text-center my-5">
        <a class="text-primary text-uppercase h5" href="/">MORE POSTS</a>
    </div>
</footer>
<script>
    var elements = document.body.getElementsByTagName('pre');
    for (var i = 0; i < elements.length; i++) {elements[i].setAttribute('class', 'prettyprint');}
</script>
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?autoload=true" defer="defer"></script>
<script id="dsq-count-scr" src="//samiei-org.disqus.com/count.js" async></script>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<script defer>
    if (window.location.hostname !== 'localhost') {
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-69085808-1', 'auto');
        ga('send', 'pageview');
    }
</script>
<script>
    const togglerSwitch = document.querySelector("#toggler");
    const currentTheme = localStorage.getItem("theme");
    const prefersDarkScheme = window.matchMedia(
        "(prefers-color-scheme: dark)"
    ).matches;

    if (currentTheme) {
        document.body.setAttribute("data-theme", currentTheme);
    if (currentTheme === "dark") {
        document.body.setAttribute("data-theme", "dark");
    }
    } else if (prefersDarkScheme) {
        document.body.setAttribute("data-theme", "dark");
    }

    function switchTheme(e) {
        e.preventDefault();

        const theme = document.body.getAttribute("data-theme");
        if (theme == "dark") {
            document.body.setAttribute("data-theme", "light");
            localStorage.setItem("theme", "light");
        } else {
            document.body.setAttribute("data-theme", "dark");
            localStorage.setItem("theme", "dark");
        }
    }

    togglerSwitch.addEventListener("click", switchTheme);
</script>
</body>
</html>
